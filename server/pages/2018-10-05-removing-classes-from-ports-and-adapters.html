<!DOCTYPE html><html><head><link rel="icon" href="https://media.made.com/mws-assets/images/favicon.1.ico"/><link media="screen,handheld" type="text/css" rel="stylesheet" href="https://media.made.com/mws-assets/fontBase_b900f8d534cc10f95604.css"/><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Removing classes from Ports and Adapters</title><meta name="next-head-count" content="3"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-24780b5468e42e63.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-a56127814584ab09.js" defer=""></script><script src="/_next/static/chunks/pages/_app-063d0cdbbc8e6a9c.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-88f3a092f15cc647.js" defer=""></script><script src="/_next/static/KQTOltHZK9VDJbo-wcIP4/_buildManifest.js" defer=""></script><script src="/_next/static/KQTOltHZK9VDJbo-wcIP4/_ssgManifest.js" defer=""></script><script src="/_next/static/KQTOltHZK9VDJbo-wcIP4/_middlewareManifest.js" defer=""></script></head><body><script>(function setScript(initialValue) {
  var mql = window.matchMedia("(prefers-color-scheme: dark)");
  var systemPreference = mql.matches ? "dark" : "light";
  var persistedPreference = systemPreference;

  try {
    persistedPreference = localStorage.getItem("chakra-ui-color-mode");
  } catch (error) {
    console.log("Chakra UI: localStorage is not available. Color mode persistence might not work as expected");
  }

  var colorMode;

  if (persistedPreference) {
    colorMode = persistedPreference;
  } else if (initialValue === "system") {
    colorMode = systemPreference;
  } else {
    colorMode = initialValue != null ? initialValue : systemPreference;
  }

  if (colorMode) {
    /**
     * Keep in sync with `root.set() {@file ./color-mode.utils.ts}
     */
    document.documentElement.style.setProperty("--chakra-ui-color-mode", colorMode);
    document.documentElement.setAttribute("data-theme", colorMode);
  }
})('light')</script><div id="__next" data-reactroot=""><style data-emotion="css-global 1co9hnp">:host,:root{--chakra-ring-inset:var(--chakra-empty,/*!*/ /*!*/);--chakra-ring-offset-width:0px;--chakra-ring-offset-color:#fff;--chakra-ring-color:rgba(66, 153, 225, 0.6);--chakra-ring-offset-shadow:0 0 #0000;--chakra-ring-shadow:0 0 #0000;--chakra-space-x-reverse:0;--chakra-space-y-reverse:0;--chakra-colors-transparent:transparent;--chakra-colors-current:currentColor;--chakra-colors-black:#000000;--chakra-colors-white:#FFFFFF;--chakra-colors-whiteAlpha-50:rgba(255, 255, 255, 0.04);--chakra-colors-whiteAlpha-100:rgba(255, 255, 255, 0.06);--chakra-colors-whiteAlpha-200:rgba(255, 255, 255, 0.08);--chakra-colors-whiteAlpha-300:rgba(255, 255, 255, 0.16);--chakra-colors-whiteAlpha-400:rgba(255, 255, 255, 0.24);--chakra-colors-whiteAlpha-500:rgba(255, 255, 255, 0.36);--chakra-colors-whiteAlpha-600:rgba(255, 255, 255, 0.48);--chakra-colors-whiteAlpha-700:rgba(255, 255, 255, 0.64);--chakra-colors-whiteAlpha-800:rgba(255, 255, 255, 0.80);--chakra-colors-whiteAlpha-900:rgba(255, 255, 255, 0.92);--chakra-colors-blackAlpha-50:rgba(0, 0, 0, 0.04);--chakra-colors-blackAlpha-100:rgba(0, 0, 0, 0.06);--chakra-colors-blackAlpha-200:rgba(0, 0, 0, 0.08);--chakra-colors-blackAlpha-300:rgba(0, 0, 0, 0.16);--chakra-colors-blackAlpha-400:rgba(0, 0, 0, 0.24);--chakra-colors-blackAlpha-500:rgba(0, 0, 0, 0.36);--chakra-colors-blackAlpha-600:rgba(0, 0, 0, 0.48);--chakra-colors-blackAlpha-700:rgba(0, 0, 0, 0.64);--chakra-colors-blackAlpha-800:rgba(0, 0, 0, 0.80);--chakra-colors-blackAlpha-900:rgba(0, 0, 0, 0.92);--chakra-colors-gray-50:#F7FAFC;--chakra-colors-gray-100:#EDF2F7;--chakra-colors-gray-200:#E2E8F0;--chakra-colors-gray-300:#CBD5E0;--chakra-colors-gray-400:#A0AEC0;--chakra-colors-gray-500:#718096;--chakra-colors-gray-600:#4A5568;--chakra-colors-gray-700:#2D3748;--chakra-colors-gray-800:#1A202C;--chakra-colors-gray-900:#171923;--chakra-colors-red-5:#fff2f0;--chakra-colors-red-10:#ffdfdd;--chakra-colors-red-50:#F15856;--chakra-colors-red-80:#d03740;--chakra-colors-red-100:#FED7D7;--chakra-colors-red-200:#FEB2B2;--chakra-colors-red-300:#FC8181;--chakra-colors-red-400:#F56565;--chakra-colors-red-500:#E53E3E;--chakra-colors-red-600:#C53030;--chakra-colors-red-700:#9B2C2C;--chakra-colors-red-800:#822727;--chakra-colors-red-900:#63171B;--chakra-colors-orange-50:#FFFAF0;--chakra-colors-orange-100:#FEEBC8;--chakra-colors-orange-200:#FBD38D;--chakra-colors-orange-300:#F6AD55;--chakra-colors-orange-400:#ED8936;--chakra-colors-orange-500:#DD6B20;--chakra-colors-orange-600:#C05621;--chakra-colors-orange-700:#9C4221;--chakra-colors-orange-800:#7B341E;--chakra-colors-orange-900:#652B19;--chakra-colors-yellow-50:#FFFFF0;--chakra-colors-yellow-100:#FEFCBF;--chakra-colors-yellow-200:#FAF089;--chakra-colors-yellow-300:#F6E05E;--chakra-colors-yellow-400:#ECC94B;--chakra-colors-yellow-500:#D69E2E;--chakra-colors-yellow-600:#B7791F;--chakra-colors-yellow-700:#975A16;--chakra-colors-yellow-800:#744210;--chakra-colors-yellow-900:#5F370E;--chakra-colors-green-5:#e4fbe5;--chakra-colors-green-10:#ccf5ce;--chakra-colors-green-50:#30a75b;--chakra-colors-green-80:#008248;--chakra-colors-green-100:#C6F6D5;--chakra-colors-green-200:#9AE6B4;--chakra-colors-green-300:#68D391;--chakra-colors-green-400:#48BB78;--chakra-colors-green-500:#38A169;--chakra-colors-green-600:#2F855A;--chakra-colors-green-700:#276749;--chakra-colors-green-800:#22543D;--chakra-colors-green-900:#1C4532;--chakra-colors-teal-50:#E6FFFA;--chakra-colors-teal-100:#B2F5EA;--chakra-colors-teal-200:#81E6D9;--chakra-colors-teal-300:#4FD1C5;--chakra-colors-teal-400:#38B2AC;--chakra-colors-teal-500:#319795;--chakra-colors-teal-600:#2C7A7B;--chakra-colors-teal-700:#285E61;--chakra-colors-teal-800:#234E52;--chakra-colors-teal-900:#1D4044;--chakra-colors-blue-50:#ebf8ff;--chakra-colors-blue-100:#bee3f8;--chakra-colors-blue-200:#90cdf4;--chakra-colors-blue-300:#63b3ed;--chakra-colors-blue-400:#4299e1;--chakra-colors-blue-500:#3182ce;--chakra-colors-blue-600:#2b6cb0;--chakra-colors-blue-700:#2c5282;--chakra-colors-blue-800:#2a4365;--chakra-colors-blue-900:#1A365D;--chakra-colors-cyan-50:#EDFDFD;--chakra-colors-cyan-100:#C4F1F9;--chakra-colors-cyan-200:#9DECF9;--chakra-colors-cyan-300:#76E4F7;--chakra-colors-cyan-400:#0BC5EA;--chakra-colors-cyan-500:#00B5D8;--chakra-colors-cyan-600:#00A3C4;--chakra-colors-cyan-700:#0987A0;--chakra-colors-cyan-800:#086F83;--chakra-colors-cyan-900:#065666;--chakra-colors-purple-50:#FAF5FF;--chakra-colors-purple-100:#E9D8FD;--chakra-colors-purple-200:#D6BCFA;--chakra-colors-purple-300:#B794F4;--chakra-colors-purple-400:#9F7AEA;--chakra-colors-purple-500:#805AD5;--chakra-colors-purple-600:#6B46C1;--chakra-colors-purple-700:#553C9A;--chakra-colors-purple-800:#44337A;--chakra-colors-purple-900:#322659;--chakra-colors-pink-50:#FFF5F7;--chakra-colors-pink-100:#FED7E2;--chakra-colors-pink-200:#FBB6CE;--chakra-colors-pink-300:#F687B3;--chakra-colors-pink-400:#ED64A6;--chakra-colors-pink-500:#D53F8C;--chakra-colors-pink-600:#B83280;--chakra-colors-pink-700:#97266D;--chakra-colors-pink-800:#702459;--chakra-colors-pink-900:#521B41;--chakra-colors-linkedin-50:#E8F4F9;--chakra-colors-linkedin-100:#CFEDFB;--chakra-colors-linkedin-200:#9BDAF3;--chakra-colors-linkedin-300:#68C7EC;--chakra-colors-linkedin-400:#34B3E4;--chakra-colors-linkedin-500:#00A0DC;--chakra-colors-linkedin-600:#008CC9;--chakra-colors-linkedin-700:#0077B5;--chakra-colors-linkedin-800:#005E93;--chakra-colors-linkedin-900:#004471;--chakra-colors-facebook-50:#E8F4F9;--chakra-colors-facebook-100:#D9DEE9;--chakra-colors-facebook-200:#B7C2DA;--chakra-colors-facebook-300:#6482C0;--chakra-colors-facebook-400:#4267B2;--chakra-colors-facebook-500:#385898;--chakra-colors-facebook-600:#314E89;--chakra-colors-facebook-700:#29487D;--chakra-colors-facebook-800:#223B67;--chakra-colors-facebook-900:#1E355B;--chakra-colors-messenger-50:#D0E6FF;--chakra-colors-messenger-100:#B9DAFF;--chakra-colors-messenger-200:#A2CDFF;--chakra-colors-messenger-300:#7AB8FF;--chakra-colors-messenger-400:#2E90FF;--chakra-colors-messenger-500:#0078FF;--chakra-colors-messenger-600:#0063D1;--chakra-colors-messenger-700:#0052AC;--chakra-colors-messenger-800:#003C7E;--chakra-colors-messenger-900:#002C5C;--chakra-colors-whatsapp-50:#dffeec;--chakra-colors-whatsapp-100:#b9f5d0;--chakra-colors-whatsapp-200:#90edb3;--chakra-colors-whatsapp-300:#65e495;--chakra-colors-whatsapp-400:#3cdd78;--chakra-colors-whatsapp-500:#22c35e;--chakra-colors-whatsapp-600:#179848;--chakra-colors-whatsapp-700:#0c6c33;--chakra-colors-whatsapp-800:#01421c;--chakra-colors-whatsapp-900:#001803;--chakra-colors-twitter-50:#E5F4FD;--chakra-colors-twitter-100:#C8E9FB;--chakra-colors-twitter-200:#A8DCFA;--chakra-colors-twitter-300:#83CDF7;--chakra-colors-twitter-400:#57BBF5;--chakra-colors-twitter-500:#1DA1F2;--chakra-colors-twitter-600:#1A94DA;--chakra-colors-twitter-700:#1681BF;--chakra-colors-twitter-800:#136B9E;--chakra-colors-twitter-900:#0D4D71;--chakra-colors-telegram-50:#E3F2F9;--chakra-colors-telegram-100:#C5E4F3;--chakra-colors-telegram-200:#A2D4EC;--chakra-colors-telegram-300:#7AC1E4;--chakra-colors-telegram-400:#47A9DA;--chakra-colors-telegram-500:#0088CC;--chakra-colors-telegram-600:#007AB8;--chakra-colors-telegram-700:#006BA1;--chakra-colors-telegram-800:#005885;--chakra-colors-telegram-900:#003F5E;--chakra-colors-made-5:#fafafa;--chakra-colors-made-10:#f5f6f4;--chakra-colors-made-20:#eef0ed;--chakra-colors-made-30:#e1e3de;--chakra-colors-made-40:#bdbfbb;--chakra-colors-made-50:#9fa19d;--chakra-colors-made-60:#767874;--chakra-colors-made-70:#626360;--chakra-colors-made-80:#434442;--chakra-colors-made-90:#222321;--chakra-colors-made-black:#131413;--chakra-colors-made-baige:#d9c3b8;--chakra-colors-made-green:#c0d0cf;--chakra-colors-made-grey:#d7d3d0;--chakra-colors-made-blue:#353F7D;--chakra-borders-none:0;--chakra-borders-1px:1px solid;--chakra-borders-2px:2px solid;--chakra-borders-4px:4px solid;--chakra-borders-8px:8px solid;--chakra-fonts-heading:FS Neruda;--chakra-fonts-body:FS Meridian Regular,sans-serif;--chakra-fonts-mono:FS Hack;--chakra-fontSizes-xs:0.75rem;--chakra-fontSizes-sm:0.875rem;--chakra-fontSizes-md:1rem;--chakra-fontSizes-lg:1.125rem;--chakra-fontSizes-xl:1.25rem;--chakra-fontSizes-2xl:1.5rem;--chakra-fontSizes-3xl:1.875rem;--chakra-fontSizes-4xl:2.25rem;--chakra-fontSizes-5xl:3rem;--chakra-fontSizes-6xl:3.75rem;--chakra-fontSizes-7xl:4.5rem;--chakra-fontSizes-8xl:6rem;--chakra-fontSizes-9xl:8rem;--chakra-fontWeights-hairline:100;--chakra-fontWeights-thin:200;--chakra-fontWeights-light:300;--chakra-fontWeights-normal:400;--chakra-fontWeights-medium:500;--chakra-fontWeights-semibold:600;--chakra-fontWeights-bold:700;--chakra-fontWeights-extrabold:800;--chakra-fontWeights-black:900;--chakra-letterSpacings-tighter:-0.05em;--chakra-letterSpacings-tight:-0.025em;--chakra-letterSpacings-normal:0;--chakra-letterSpacings-wide:0.025em;--chakra-letterSpacings-wider:0.05em;--chakra-letterSpacings-widest:0.1em;--chakra-lineHeights-3:.75rem;--chakra-lineHeights-4:1rem;--chakra-lineHeights-5:1.25rem;--chakra-lineHeights-6:1.5rem;--chakra-lineHeights-7:1.75rem;--chakra-lineHeights-8:2rem;--chakra-lineHeights-9:2.25rem;--chakra-lineHeights-10:2.5rem;--chakra-lineHeights-normal:normal;--chakra-lineHeights-none:1;--chakra-lineHeights-shorter:1.25;--chakra-lineHeights-short:1.375;--chakra-lineHeights-base:1.5;--chakra-lineHeights-tall:1.625;--chakra-lineHeights-taller:2;--chakra-radii-none:0;--chakra-radii-sm:0.125rem;--chakra-radii-base:0.25rem;--chakra-radii-md:0.375rem;--chakra-radii-lg:0.5rem;--chakra-radii-xl:0.75rem;--chakra-radii-2xl:1rem;--chakra-radii-3xl:1.5rem;--chakra-radii-full:9999px;--chakra-space-1:0.25rem;--chakra-space-2:0.5rem;--chakra-space-3:0.75rem;--chakra-space-4:1rem;--chakra-space-5:1.25rem;--chakra-space-6:1.5rem;--chakra-space-7:1.75rem;--chakra-space-8:2rem;--chakra-space-9:2.25rem;--chakra-space-10:2.5rem;--chakra-space-12:3rem;--chakra-space-14:3.5rem;--chakra-space-16:4rem;--chakra-space-20:5rem;--chakra-space-24:6rem;--chakra-space-28:7rem;--chakra-space-32:8rem;--chakra-space-36:9rem;--chakra-space-40:10rem;--chakra-space-44:11rem;--chakra-space-48:12rem;--chakra-space-52:13rem;--chakra-space-56:14rem;--chakra-space-60:15rem;--chakra-space-64:16rem;--chakra-space-72:18rem;--chakra-space-80:20rem;--chakra-space-96:24rem;--chakra-space-px:1px;--chakra-space-0-5:0.125rem;--chakra-space-1-5:0.375rem;--chakra-space-2-5:0.625rem;--chakra-space-3-5:0.875rem;--chakra-shadows-xs:0 0 0 1px rgba(0, 0, 0, 0.05);--chakra-shadows-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--chakra-shadows-base:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);--chakra-shadows-md:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);--chakra-shadows-lg:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);--chakra-shadows-xl:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04);--chakra-shadows-2xl:0 25px 50px -12px rgba(0, 0, 0, 0.25);--chakra-shadows-outline:0 0 0 3px rgba(66, 153, 225, 0.6);--chakra-shadows-inner:inset 0 2px 4px 0 rgba(0,0,0,0.06);--chakra-shadows-none:none;--chakra-shadows-dark-lg:rgba(0, 0, 0, 0.1) 0px 0px 0px 1px,rgba(0, 0, 0, 0.2) 0px 5px 10px,rgba(0, 0, 0, 0.4) 0px 15px 40px;--chakra-sizes-1:0.25rem;--chakra-sizes-2:0.5rem;--chakra-sizes-3:0.75rem;--chakra-sizes-4:1rem;--chakra-sizes-5:1.25rem;--chakra-sizes-6:1.5rem;--chakra-sizes-7:1.75rem;--chakra-sizes-8:2rem;--chakra-sizes-9:2.25rem;--chakra-sizes-10:2.5rem;--chakra-sizes-12:3rem;--chakra-sizes-14:3.5rem;--chakra-sizes-16:4rem;--chakra-sizes-20:5rem;--chakra-sizes-24:6rem;--chakra-sizes-28:7rem;--chakra-sizes-32:8rem;--chakra-sizes-36:9rem;--chakra-sizes-40:10rem;--chakra-sizes-44:11rem;--chakra-sizes-48:12rem;--chakra-sizes-52:13rem;--chakra-sizes-56:14rem;--chakra-sizes-60:15rem;--chakra-sizes-64:16rem;--chakra-sizes-72:18rem;--chakra-sizes-80:20rem;--chakra-sizes-96:24rem;--chakra-sizes-px:1px;--chakra-sizes-0-5:0.125rem;--chakra-sizes-1-5:0.375rem;--chakra-sizes-2-5:0.625rem;--chakra-sizes-3-5:0.875rem;--chakra-sizes-max:max-content;--chakra-sizes-min:min-content;--chakra-sizes-full:100%;--chakra-sizes-3xs:14rem;--chakra-sizes-2xs:16rem;--chakra-sizes-xs:20rem;--chakra-sizes-sm:24rem;--chakra-sizes-md:28rem;--chakra-sizes-lg:32rem;--chakra-sizes-xl:36rem;--chakra-sizes-2xl:42rem;--chakra-sizes-3xl:48rem;--chakra-sizes-4xl:56rem;--chakra-sizes-5xl:64rem;--chakra-sizes-6xl:72rem;--chakra-sizes-7xl:80rem;--chakra-sizes-8xl:90rem;--chakra-sizes-container-sm:640px;--chakra-sizes-container-md:768px;--chakra-sizes-container-lg:1024px;--chakra-sizes-container-xl:1280px;--chakra-zIndices-hide:-1;--chakra-zIndices-auto:auto;--chakra-zIndices-base:0;--chakra-zIndices-docked:10;--chakra-zIndices-dropdown:1000;--chakra-zIndices-sticky:1100;--chakra-zIndices-banner:1200;--chakra-zIndices-overlay:1300;--chakra-zIndices-modal:1400;--chakra-zIndices-popover:1500;--chakra-zIndices-skipLink:1600;--chakra-zIndices-toast:1700;--chakra-zIndices-tooltip:1800;--chakra-transition-property-common:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform;--chakra-transition-property-colors:background-color,border-color,color,fill,stroke;--chakra-transition-property-dimensions:width,height;--chakra-transition-property-position:left,right,top,bottom;--chakra-transition-property-background:background-color,background-image,background-position;--chakra-transition-easing-ease-in:cubic-bezier(0.4, 0, 1, 1);--chakra-transition-easing-ease-out:cubic-bezier(0, 0, 0.2, 1);--chakra-transition-easing-ease-in-out:cubic-bezier(0.4, 0, 0.2, 1);--chakra-transition-duration-ultra-fast:50ms;--chakra-transition-duration-faster:100ms;--chakra-transition-duration-fast:150ms;--chakra-transition-duration-normal:200ms;--chakra-transition-duration-slow:300ms;--chakra-transition-duration-slower:400ms;--chakra-transition-duration-ultra-slow:500ms;--chakra-blur-none:0;--chakra-blur-sm:4px;--chakra-blur-base:8px;--chakra-blur-md:12px;--chakra-blur-lg:16px;--chakra-blur-xl:24px;--chakra-blur-2xl:40px;--chakra-blur-3xl:64px;}</style><style data-emotion="css-global 1jqlf9g">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;font-feature-settings:'kern';}*,*::before,*::after{border-width:0;border-style:solid;box-sizing:border-box;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bold;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}body,blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}img,svg,video,canvas,audio,iframe,embed,object{display:block;}img,video{max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]){outline:none;box-shadow:none;}select::-ms-expand{display:none;}</style><style data-emotion="css-global 1baqkrf">body{font-family:var(--chakra-fonts-body);color:var(--chakra-colors-gray-800);background:var(--chakra-colors-white);transition-property:background-color;transition-duration:var(--chakra-transition-duration-normal);line-height:var(--chakra-lineHeights-base);}*::-webkit-input-placeholder{color:var(--chakra-colors-gray-400);}*::-moz-placeholder{color:var(--chakra-colors-gray-400);}*:-ms-input-placeholder{color:var(--chakra-colors-gray-400);}*::placeholder{color:var(--chakra-colors-gray-400);}*,*::before,::after{border-color:var(--chakra-colors-gray-200);word-wrap:break-word;}</style><style data-emotion="css mfxtb">.css-mfxtb{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;box-shadow:var(--chakra-shadows-base);width:100%;margin-bottom:var(--chakra-space-8);padding:var(--chakra-space-8);}</style><header class="css-mfxtb"><style data-emotion="css 18ci58h">.css-18ci58h{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;max-width:var(--chakra-sizes-8xl);width:100%;margin:auto;}</style><div class="css-18ci58h"><div class="css-0"><a href="/"><img alt="Logo" src="https://media.made.com/mws-assets/images/MadeLogo.2.svg" class="chakra-image css-0" aria-label="Logo"/></a></div><style data-emotion="css 1wsmmqi">@media screen and (min-width: 30em){.css-1wsmmqi{display:block;}}@media screen and (min-width: 48em){.css-1wsmmqi{display:none;}}</style><div class="css-1wsmmqi"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div><style data-emotion="css 3txhs">.css-3txhs{display:none;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;margin-left:auto;}@media screen and (min-width: 48em){.css-3txhs{display:block;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;}}</style><div class="css-3txhs"><style data-emotion="css 1lpw2d">.css-1lpw2d{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-top:var(--chakra-space-4);}.css-1lpw2d>*:not(style)~*:not(style){margin-top:var(--chakra-space-8);-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0px;margin-inline-start:0px;}@media screen and (min-width: 30em){.css-1lpw2d{-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-top:var(--chakra-space-4);}.css-1lpw2d>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:var(--chakra-space-8);margin-inline-start:var(--chakra-space-8);}}@media screen and (min-width: 48em){.css-1lpw2d{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-top:0px;}.css-1lpw2d>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:var(--chakra-space-8);margin-inline-start:var(--chakra-space-8);}}@media screen and (min-width: 62em){.css-1lpw2d{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-top:0px;}.css-1lpw2d>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:var(--chakra-space-8);margin-inline-start:var(--chakra-space-8);}}</style><div class="chakra-stack css-1lpw2d"><style data-emotion="css f4h6uy">.css-f4h6uy{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:inherit;}.css-f4h6uy:hover,.css-f4h6uy[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-f4h6uy:focus,.css-f4h6uy[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a target="" class="chakra-link css-f4h6uy" href="/"><style data-emotion="css 1twuvi0">.css-1twuvi0{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;}.css-1twuvi0>*:not(style)~*:not(style){margin-top:0px;-webkit-margin-end:0px;margin-inline-end:0px;margin-bottom:0px;-webkit-margin-start:0.5rem;margin-inline-start:0.5rem;}</style><div class="chakra-stack css-1twuvi0"><p class="chakra-text css-0">Home</p></div></a><a target="_blank" class="chakra-link css-f4h6uy" href="https://www.made.com/careers"><div class="chakra-stack css-1twuvi0"><p class="chakra-text css-0">Careers</p><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></div></a></div></div></div></header><style data-emotion="css rkbxzj">.css-rkbxzj{width:100%;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;max-width:var(--chakra-sizes-4xl);-webkit-padding-start:1rem;padding-inline-start:1rem;-webkit-padding-end:1rem;padding-inline-end:1rem;}</style><div class="chakra-container css-rkbxzj"><style data-emotion="css 1xr7jem">.css-1xr7jem{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:var(--chakra-fontSizes-5xl);line-height:1;margin-bottom:var(--chakra-space-6);}@media screen and (min-width: 48em){.css-1xr7jem{font-size:var(--chakra-fontSizes-6xl);}}</style><h1 class="chakra-heading css-1xr7jem">Removing classes from Ports and Adapters</h1><style data-emotion="css 1iv087f">.css-1iv087f{margin-bottom:var(--chakra-space-2);font-weight:var(--chakra-fontWeights-bold);}</style><p class="chakra-text css-1iv087f">by <!-- -->Harry</p><style data-emotion="css b64cj9">.css-b64cj9{margin-bottom:var(--chakra-space-4);color:var(--chakra-colors-made-50);}</style><p class="chakra-text css-b64cj9">Fri Oct 05 2018</p><style data-emotion="css rszk63">.css-rszk63{margin-bottom:var(--chakra-space-4);}</style><p class="chakra-text css-rszk63">Hi, I&#x27;m Harry, Bob&#x27;s coauthor for this series on architecture. Now I don&#x27;t pretend to be
an architect<!-- -->*<!-- -->, but I do know a bit about Python. You know the apocryphal tale about
<style data-emotion="css 1ud5qxa">.css-1ud5qxa{transition-property:var(--chakra-transition-property-common);transition-duration:var(--chakra-transition-duration-fast);transition-timing-function:var(--chakra-transition-easing-ease-out);cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:2px solid transparent;outline-offset:2px;color:var(--chakra-colors-made-blue);}.css-1ud5qxa:hover,.css-1ud5qxa[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1ud5qxa:focus,.css-1ud5qxa[data-focus]{box-shadow:var(--chakra-shadows-outline);}</style><a target="_blank" class="chakra-link css-1ud5qxa" href="https://en.wikipedia.org/wiki/Law_of_triviality">bikeshedding</a>? Everyone wants to be
able to express an opinion, even if it&#x27;s only about the colour of the bikesheds? Well
this will be me essentially doing that about Bob&#x27;s code. Not questioning the
architecture. Just the cosmetics. But, readability counts, so here we go!</p><p class="chakra-text css-rszk63">&quot;Stop Writing Classes&quot; Despite the fact that Bob swears blind that he was a functional
programmer for years, I think Bob does occasionally let the OO-heavy habits of the C#
world take over, and he sees classes everywhere, including plenty of places where they
don&#x27;t really help. OK OK, arguably don&#x27;t help.</p><p class="chakra-text css-rszk63">Like the man said, <a target="_blank" class="chakra-link css-1ud5qxa" href="https://www.youtube.com/watch?v=o9pEzgHorH0">Stop Writing Classes</a>,
or escape from the
<a target="_blank" class="chakra-link css-1ud5qxa" href="https://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html">Kingdom of Nouns!</a>,
or perhaps simply:</p><p class="chakra-text css-rszk63">It is not enough to simply stop writing Java. You must also stop yourself from writing
Java using Another Language.</p><p class="chakra-text css-rszk63">Let&#x27;s see if we can&#x27;t replace a few classes with some more Pythonic patterns, and see if
it makes some of those architectural patterns easier to read, implement and understand.</p><style data-emotion="css 1mv11rx">.css-1mv11rx{border-left:var(--chakra-borders-2px);border-left-color:var(--chakra-colors-made-blue);padding-top:var(--chakra-space-3);-webkit-padding-start:var(--chakra-space-3);padding-inline-start:var(--chakra-space-3);-webkit-padding-end:var(--chakra-space-3);padding-inline-end:var(--chakra-space-3);margin-bottom:var(--chakra-space-4);overflow:auto;opacity:80%;}</style><blockquote class="css-1mv11rx"><i class="chakra-text css-0"><p class="chakra-text css-rszk63">Command handlers as functions If a class only has one method other than its
constructor, it should probably be a function</p><p class="chakra-text css-rszk63"><em>Jack Diederich</em></p></i></blockquote><p class="chakra-text css-rszk63">or</p><blockquote class="css-1mv11rx"><i class="chakra-text css-0"><p class="chakra-text css-rszk63">look for classes with names like &quot;Handler&quot;, &quot;Maker&quot;, &quot;Builder&quot;, &quot;Factory&quot;, and you&#x27;ll
probably find some good candidates for converting to functions</p><p class="chakra-text css-rszk63"><em>Me. but hardly a novel thought.</em></p></i></blockquote><p class="chakra-text css-rszk63">If you&#x27;re implementing the Command Handler pattern, you&#x27;re going to need to represent
commands and handlers.</p><p class="chakra-text css-rszk63">For commands I can&#x27;t really fault Bob&#x27;s use of namedtuples, as imported from the typing
module:</p><div class="remark-highlight"><pre class="language-python"><style data-emotion="css e69dqy">.css-e69dqy{position:relative;z-index:0;}</style><div class="css-e69dqy"><style data-emotion="css 13wyh5o">.css-13wyh5o{padding:var(--chakra-space-5);overflow:hidden;background:var(--chakra-colors-orange-50);border-radius:10px;margin-bottom:var(--chakra-space-10);font-size:var(--chakra-fontSizes-sm);box-shadow:var(--chakra-shadows-lg);}</style><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">class</span> <span class="token class-name">ReportIssueCommand</span><span class="token punctuation">(</span>NamedTuple<span class="token punctuation">)</span><span class="token punctuation">:</span>
    issue_id<span class="token punctuation">:</span> UUID
    reporter_name<span class="token punctuation">:</span> <span class="token builtin">str</span>
    reporter_email<span class="token punctuation">:</span> <span class="token builtin">str</span>
    problem_description<span class="token punctuation">:</span> <span class="token builtin">str</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">Unless you&#x27;re actually using mypy, those types aren&#x27;t adding much value however. The
alternative would be the more &quot;classic&quot; namedtuple syntax:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0">ReportIssueCommand <span class="token operator">=</span> NamedTuple<span class="token punctuation">(</span>
    <span class="token string">&quot;ReportIssueCommand&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;issue_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;reporter_name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;reporter_email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;problem_description&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</div></div></div></pre></div><style data-emotion="css 1jb3vzl">.css-1jb3vzl{font-family:var(--chakra-fonts-heading);font-weight:var(--chakra-fontWeights-bold);font-size:var(--chakra-fontSizes-2xl);line-height:1.33;}@media screen and (min-width: 48em){.css-1jb3vzl{font-size:var(--chakra-fontSizes-3xl);line-height:1.2;}}</style><h3 class="chakra-heading css-1jb3vzl">or the shorter syntax if it doesn&#x27;t make you nervous:</h3><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0">ReportIssueCommand <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span>
    <span class="token string">&quot;ReportIssueCommand&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;issue_id reporter_name reporter_email problem_description&quot;</span>
<span class="token punctuation">)</span>
</div></div></div></pre></div><h3 class="chakra-heading css-1jb3vzl">come on, have you seen the implementation? nameduples are magic anyway. get with it!</h3><p class="chakra-text css-rszk63">This wasn&#x27;t available at the time of writing, but
<a target="_blank" class="chakra-link css-1ud5qxa" href="https://docs.python.org/3/library/dataclasses.html">Python 3.7 dataclasses</a> might be
worth a look too. You&#x27;d probably want to use frozen=True to replicate the immutabilty of
namedtuples...</p><p class="chakra-text css-rszk63">But for handlers, use of a class is definitely more up for debate:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">class</span> <span class="token class-name">ReportIssueHandler</span><span class="token punctuation">(</span>Handles<span class="token punctuation">[</span>messages<span class="token punctuation">.</span>ReportIssueCommand<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> uowm<span class="token punctuation">:</span> UnitOfWorkManager<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>uowm <span class="token operator">=</span> uowm

    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>
        reporter <span class="token operator">=</span> IssueReporter<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>reporter_name<span class="token punctuation">,</span> cmd<span class="token punctuation">.</span>reporter_email<span class="token punctuation">)</span>
        issue <span class="token operator">=</span> Issue<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>issue_id<span class="token punctuation">,</span> reporter<span class="token punctuation">,</span> cmd<span class="token punctuation">.</span>problem_description<span class="token punctuation">)</span>

        <span class="token keyword">with</span> self<span class="token punctuation">.</span>uowm<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> uow<span class="token punctuation">:</span>
            uow<span class="token punctuation">.</span>issues<span class="token punctuation">.</span>add<span class="token punctuation">(</span>issue<span class="token punctuation">)</span>
            uow<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">Using a class like this does buy you a nice separation of the dependencies to be
injected (in the constructor) and the actual command that the handler will be applied
to.</p><p class="chakra-text css-rszk63">But the word &quot;handler&quot; definitely feels like a case of nouning a verb. So, consider:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">def</span> <span class="token function">report_issue</span><span class="token punctuation">(</span>start_uow<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>
    reporter <span class="token operator">=</span> IssueReporter<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>reporter_name<span class="token punctuation">,</span> cmd<span class="token punctuation">.</span>reporter_email<span class="token punctuation">)</span>
    issue <span class="token operator">=</span> Issue<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>issue_id<span class="token punctuation">,</span> reporter<span class="token punctuation">,</span> cmd<span class="token punctuation">.</span>problem_description<span class="token punctuation">)</span>
    <span class="token keyword">with</span> start_uow<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> uow<span class="token punctuation">:</span>
        uow<span class="token punctuation">.</span>issues<span class="token punctuation">.</span>add<span class="token punctuation">(</span>issue<span class="token punctuation">)</span>
        uow<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">tying commands to handlers You need some way of connecting commands with their handlers.
The most boring way of doing that is in some sort of bootstrap/config code (as in this
example) but you might want also want to do so &quot;inline&quot; in your handler definition.</p><p class="chakra-text css-rszk63">Bob&#x27;s way, where the handler class inherits from Handles<!-- -->[message.ReportIssueCommand]<!-- -->
definitely deserves some points for being easily readable, but you really don&#x27;t want to
get into the sausage-factory of the actual implementation, involving, as it does, the
controversial typing module.</p><p class="chakra-text css-rszk63">You might be more comfortable with a decorator instead:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token decorator annotation punctuation">@handles</span><span class="token punctuation">(</span>messages<span class="token punctuation">.</span>ReportIssueCommand<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">report_issue</span><span class="token punctuation">(</span>start_uow<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">But it might get confusing if you also want to use decorators for dependency injection:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token decorator annotation punctuation">@inject</span><span class="token punctuation">(</span><span class="token string">&#x27;start_uow&#x27;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">report_issue</span><span class="token punctuation">(</span>start_uow<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">managing units of work without a <code>UnitOfWorkManager</code> The Unit of Work pattern is one of
the more straightforward ones; it&#x27;s easy to understand why you might want to manage
blocks of code that need to be executed &quot;together&quot; and atomically.</p><p class="chakra-text css-rszk63">In a simple project that might just mean wrapping everything in a single database
transaction, but you might also want to manage some other types of permanent storage
(filesystem, cloud storage...).</p><p class="chakra-text css-rszk63">If you&#x27;re using <a target="_blank" class="chakra-link css-1ud5qxa" href="https://io.made.com/why-use-domain-events/">domain events</a>, you might
also want to apply the unit-of-work concept to them as well: for a given block of code,
perhaps a command handler, either raise all the events in the happy case, or raise none
at all (analogous to a rollback) if an error occurs at any point. This gives you the
option to replay the command handler later without worrying about duplicate events.</p><p class="chakra-text css-rszk63">In that case your unit of work manager needs to grow some logic for tracking a stack of
events raised by a block of code, as suggested in the
<a target="_blank" class="chakra-link css-1ud5qxa" href="https://io.made.com/why-use-domain-events/">domain events post</a>.</p><p class="chakra-text css-rszk63">a unit of work should probably be a context manager Either way, Bob nailed it, a Python
context manager is the right pattern here. Here&#x27;s the outline of his class-based one:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">class</span> <span class="token class-name">SqlAlchemyUnitOfWork</span><span class="token punctuation">(</span>UnitOfWork<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session_factory<span class="token punctuation">,</span> bus<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>session <span class="token operator">=</span> self<span class="token punctuation">.</span>session_factory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>publish_events<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">commit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">publish_events</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">It&#x27;s great! but does the rest of the implementation really need to involve three
different classes?</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">class</span> <span class="token class-name">SqlAlchemy</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> uri<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_session_maker <span class="token operator">=</span> scoped_session<span class="token punctuation">(</span>sessionmaker<span class="token punctuation">(</span>self<span class="token punctuation">.</span>engine<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">unit_of_work_manager</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> SqlAlchemyUnitOfWorkManager<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_session_maker<span class="token punctuation">,</span> self<span class="token punctuation">.</span>bus<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">SqlAlchemyUnitOfWorkManager</span><span class="token punctuation">(</span>UnitOfWorkManager<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session_factory<span class="token punctuation">:</span> SessionFactory<span class="token punctuation">,</span> bus<span class="token punctuation">:</span> MessageBus<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>session_factory <span class="token operator">=</span> session_factory
        self<span class="token punctuation">.</span>bus <span class="token operator">=</span> bus

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> SqlAlchemyUnitOfWork<span class="token punctuation">(</span>self<span class="token punctuation">.</span>session_factory<span class="token punctuation">,</span> self<span class="token punctuation">.</span>bus<span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">Each class does have a purpose of course:</p><ul><li>SqlAlchemy captures config info about SqlAlchemy and our database engine, it has
methods like create_schema that can re-create the database for us if we need.</li><li>SqlAlchemyUnitOfWorkManager is meant to hold logic about when to create new database
sessions and when to re-use existing ones, and it ties the message bus to each unit of
work.</li><li>SqlAlchemyUnitOfWork is the actual context manager that holds the logic for commits,
rollbacks, and publishing events atomically.</li></ul><p class="chakra-text css-rszk63">But can we make things a little simpler? SqlAlchemy (the library) already knows how
manage sessions for us. Perhaps we could just have one model for the database, and
another for the units of work?</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker

<span class="token keyword">class</span> <span class="token class-name">SqlAlchemy</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> uri<span class="token punctuation">,</span> bus<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>session_factory <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>self<span class="token punctuation">.</span>engine<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>bus <span class="token operator">=</span> bus

    <span class="token keyword">def</span> <span class="token function">start_unit_of_work</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> SqlAlchemyUnitOfWork<span class="token punctuation">(</span>self<span class="token punctuation">.</span>session_factory<span class="token punctuation">,</span> self<span class="token punctuation">.</span>bus<span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">could you use an @contextmanager? We&#x27;re down to just two classes. Next you might ask
whether you really need a class for your unit of work context manager. If your client
code doesn&#x27;t need to call a commit method explicitly, then you might be able to get away
with a single method, using contextlib.contextmanager and the yield keyword:</p><p class="chakra-text css-rszk63">from contextlib import contextmanager</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token keyword">class</span> <span class="token class-name">SqlAlchemy</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token decorator annotation punctuation">@contextmanager</span>
    <span class="token keyword">def</span> <span class="token function">start_unit_of_work</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        session <span class="token operator">=</span> self<span class="token punctuation">.</span>session_factory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        events <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> session
            self<span class="token punctuation">.</span>publish_events<span class="token punctuation">(</span>session<span class="token punctuation">)</span>
            session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            session<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
            session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">publish_events</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">:</span>
        flushed_objects <span class="token operator">=</span> <span class="token punctuation">[</span>e <span class="token keyword">for</span> e <span class="token keyword">in</span> session<span class="token punctuation">.</span>new<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>e <span class="token keyword">for</span> e <span class="token keyword">in</span> session<span class="token punctuation">.</span>dirty<span class="token punctuation">]</span>
        <span class="token keyword">for</span> o <span class="token keyword">in</span> flushed_objects<span class="token punctuation">:</span>
            <span class="token keyword">for</span> e <span class="token keyword">in</span> o<span class="token punctuation">.</span>events
                self<span class="token punctuation">.</span>bus<span class="token punctuation">.</span>handle<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">the singleton pattern in Python We still have one final class, SqlAlchemy, which exists
to</p><ul><li>know how to talk to our database</li><li>give us units of work</li><li>tie the message bus to it.</li></ul><p class="chakra-text css-rszk63">It&#x27;s essentially a singleton, in that our application is only ever meant to have one
instance of it. There are lots of ways to implement the singleton pattern in Python
<!-- -->[https://stackoverflow.com/questions/31875/is-there-a-simple-elegant-way-to-define-singletons]</p><p class="chakra-text css-rszk63">In this case our implementation is the ultra-simple &quot;by convention there is only one
instance of this class&quot;, which is has a lot going for it in terms of ways to implement
the singleton pattern, compared to all the complicated code-based solutions linked
above. If you do want a code-based solution, or if you want to continue experimenting
with non-class-based solutions to these problems, why not use the &quot;just use a module&quot;
solution - modules are essentially already singletons, in Python:</p><div class="remark-highlight"><pre class="language-python"><div class="css-e69dqy"><div class="css-13wyh5o"><div class="css-0"><span class="token comment"># adapters/sqlalchemy.py</span>

BUS <span class="token operator">=</span> <span class="token boolean">None</span>
SESSION_MAKER <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment"># to be called in our bootstrap/config script</span>

<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> bus<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">global</span> BUS<span class="token punctuation">,</span> SESSION_MAKER
  BUS <span class="token operator">=</span> bus
  SESSION_MAKER <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>create_engine<span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@contextmanager</span>
<span class="token keyword">def</span> <span class="token function">start_unit_of_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session <span class="token operator">=</span> SESSION_MAKER<span class="token punctuation">(</span><span class="token punctuation">)</span>
    events <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> session
        _publish_events<span class="token punctuation">(</span>session<span class="token punctuation">)</span>
        session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
        session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">_publish_events</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>
    flushed_objects <span class="token operator">=</span> <span class="token punctuation">[</span>e <span class="token keyword">for</span> e <span class="token keyword">in</span> session<span class="token punctuation">.</span>new<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>e <span class="token keyword">for</span> e <span class="token keyword">in</span> session<span class="token punctuation">.</span>dirty<span class="token punctuation">]</span>
    <span class="token keyword">for</span> o <span class="token keyword">in</span> flushed_objects<span class="token punctuation">:</span>
      <span class="token keyword">for</span> e <span class="token keyword">in</span> o<span class="token punctuation">.</span>events BUS<span class="token punctuation">.</span>handle<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
</div></div></div></pre></div><p class="chakra-text css-rszk63">We may be drifting a little too far into &quot;removing classes for its own sake&quot; territory
here. But hopefully you now have a few more options to use for inspiration in your own
code.</p><hr/><p class="chakra-text css-rszk63">*<!-- -->NARRATORS VOICE: Harry pretends to be an architect all the time</p></div><style data-emotion="css bupnvw">.css-bupnvw{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;background:#F8F8F8;bottom:0px;left:0px;width:100%;position:fixed;}</style><footer role="contentinfo" class="css-bupnvw"><style data-emotion="css 18ci58h">.css-18ci58h{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;max-width:var(--chakra-sizes-8xl);width:100%;margin:auto;}</style><div class="css-18ci58h"></div></footer><span></span></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"var u=Object.defineProperty,l=Object.defineProperties;var i=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var m=(e,n,s)=\u003en in e?u(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,a=(e,n)=\u003e{for(var s in n||(n={}))p.call(n,s)\u0026\u0026m(e,s,n[s]);if(o)for(var s of o(n))c.call(n,s)\u0026\u0026m(e,s,n[s]);return e},r=(e,n)=\u003el(e,i(n));var N=(e,n)=\u003e{var s={};for(var t in e)p.call(e,t)\u0026\u0026n.indexOf(t)\u003c0\u0026\u0026(s[t]=e[t]);if(e!=null\u0026\u0026o)for(var t of o(e))n.indexOf(t)\u003c0\u0026\u0026c.call(e,t)\u0026\u0026(s[t]=e[t]);return s};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(s){var t=s,{components:e}=t,n=N(t,[\"components\"]);return mdx(MDXLayout,r(a(a({},layoutProps),n),{components:e,mdxType:\"MDXLayout\"}),mdx(\"p\",null,`Hi, I'm Harry, Bob's coauthor for this series on architecture. Now I don't pretend to be\nan architect`,\"*\",`, but I do know a bit about Python. You know the apocryphal tale about\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://en.wikipedia.org/wiki/Law_of_triviality\"}),\"bikeshedding\"),`? Everyone wants to be\nable to express an opinion, even if it's only about the colour of the bikesheds? Well\nthis will be me essentially doing that about Bob's code. Not questioning the\narchitecture. Just the cosmetics. But, readability counts, so here we go!`),mdx(\"p\",null,`\"Stop Writing Classes\" Despite the fact that Bob swears blind that he was a functional\nprogrammer for years, I think Bob does occasionally let the OO-heavy habits of the C#\nworld take over, and he sees classes everywhere, including plenty of places where they\ndon't really help. OK OK, arguably don't help.`),mdx(\"p\",null,\"Like the man said, \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://www.youtube.com/watch?v=o9pEzgHorH0\"}),\"Stop Writing Classes\"),`,\nor escape from the\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html\"}),\"Kingdom of Nouns!\"),`,\nor perhaps simply:`),mdx(\"p\",null,`It is not enough to simply stop writing Java. You must also stop yourself from writing\nJava using Another Language.`),mdx(\"p\",null,`Let's see if we can't replace a few classes with some more Pythonic patterns, and see if\nit makes some of those architectural patterns easier to read, implement and understand.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},`Command handlers as functions If a class only has one method other than its\nconstructor, it should probably be a function`),mdx(\"p\",{parentName:\"blockquote\"},mdx(\"em\",{parentName:\"p\"},\"Jack Diederich\"))),mdx(\"p\",null,\"or\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},`look for classes with names like \"Handler\", \"Maker\", \"Builder\", \"Factory\", and you'll\nprobably find some good candidates for converting to functions`),mdx(\"p\",{parentName:\"blockquote\"},mdx(\"em\",{parentName:\"p\"},\"Me. but hardly a novel thought.\"))),mdx(\"p\",null,`If you're implementing the Command Handler pattern, you're going to need to represent\ncommands and handlers.`),mdx(\"p\",null,`For commands I can't really fault Bob's use of namedtuples, as imported from the typing\nmodule:`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"ReportIssueCommand\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"NamedTuple\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    issue_id`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),` UUID\n    reporter_name`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"str\"),`\n    reporter_email`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"str\"),`\n    problem_description`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token builtin\"}),\"str\"),`\n`))),mdx(\"p\",null,`Unless you're actually using mypy, those types aren't adding much value however. The\nalternative would be the more \"classic\" namedtuple syntax:`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),\"ReportIssueCommand \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" NamedTuple\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"ReportIssueCommand\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"issue_id\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"reporter_name\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"reporter_email\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"problem_description\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"h3\",null,\"or the shorter syntax if it doesn't make you nervous:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),\"ReportIssueCommand \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" namedtuple\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"ReportIssueCommand\"'),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),'\"issue_id reporter_name reporter_email problem_description\"'),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"h3\",null,\"come on, have you seen the implementation? nameduples are magic anyway. get with it!\"),mdx(\"p\",null,`This wasn't available at the time of writing, but\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://docs.python.org/3/library/dataclasses.html\"}),\"Python 3.7 dataclasses\"),` might be\nworth a look too. You'd probably want to use frozen=True to replicate the immutabilty of\nnamedtuples...`),mdx(\"p\",null,\"But for handlers, use of a class is definitely more up for debate:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"ReportIssueHandler\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"Handles\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"messages\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"ReportIssueCommand\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__init__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" uowm\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" UnitOfWorkManager\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"uowm \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` uowm\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"handle\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        reporter `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" IssueReporter\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"reporter_name\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"reporter_email\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        issue `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Issue\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"issue_id\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" reporter\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"problem_description\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"with\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"uowm\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"start\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"as\"),\" uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n            uow`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"issues\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"add\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"issue\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            uow`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"commit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,`Using a class like this does buy you a nice separation of the dependencies to be\ninjected (in the constructor) and the actual command that the handler will be applied\nto.`),mdx(\"p\",null,'But the word \"handler\" definitely feels like a case of nouning a verb. So, consider:'),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"report_issue\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"start_uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    reporter `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" IssueReporter\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"reporter_name\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"reporter_email\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    issue `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Issue\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"issue_id\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" reporter\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"problem_description\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"with\"),\" start_uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"as\"),\" uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        uow`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"issues\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"add\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"issue\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        uow`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"commit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,`tying commands to handlers You need some way of connecting commands with their handlers.\nThe most boring way of doing that is in some sort of bootstrap/config code (as in this\nexample) but you might want also want to do so \"inline\" in your handler definition.`),mdx(\"p\",null,\"Bob's way, where the handler class inherits from Handles\",\"[message.ReportIssueCommand]\",`\ndefinitely deserves some points for being easily readable, but you really don't want to\nget into the sausage-factory of the actual implementation, involving, as it does, the\ncontroversial typing module.`),mdx(\"p\",null,\"You might be more comfortable with a decorator instead:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator annotation punctuation\"}),\"@handles\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"messages\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"ReportIssueCommand\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"report_issue\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"start_uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`))),mdx(\"p\",null,\"But it might get confusing if you also want to use decorators for dependency injection:\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator annotation punctuation\"}),\"@inject\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token string\"}),\"'start_uow'\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"report_issue\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"start_uow\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" cmd\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`))),mdx(\"p\",null,\"managing units of work without a \",mdx(\"inlineCode\",{parentName:\"p\"},\"UnitOfWorkManager\"),` The Unit of Work pattern is one of\nthe more straightforward ones; it's easy to understand why you might want to manage\nblocks of code that need to be executed \"together\" and atomically.`),mdx(\"p\",null,`In a simple project that might just mean wrapping everything in a single database\ntransaction, but you might also want to manage some other types of permanent storage\n(filesystem, cloud storage...).`),mdx(\"p\",null,\"If you're using \",mdx(\"a\",a({parentName:\"p\"},{href:\"https://io.made.com/why-use-domain-events/\"}),\"domain events\"),`, you might\nalso want to apply the unit-of-work concept to them as well: for a given block of code,\nperhaps a command handler, either raise all the events in the happy case, or raise none\nat all (analogous to a rollback) if an error occurs at any point. This gives you the\noption to replay the command handler later without worrying about duplicate events.`),mdx(\"p\",null,`In that case your unit of work manager needs to grow some logic for tracking a stack of\nevents raised by a block of code, as suggested in the\n`,mdx(\"a\",a({parentName:\"p\"},{href:\"https://io.made.com/why-use-domain-events/\"}),\"domain events post\"),\".\"),mdx(\"p\",null,`a unit of work should probably be a context manager Either way, Bob nailed it, a Python\ncontext manager is the right pattern here. Here's the outline of his class-based one:`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"SqlAlchemyUnitOfWork\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"UnitOfWork\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__init__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__enter__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"events \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),` self\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__exit__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"close\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"publish_events\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"commit\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"publish_events\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" ctx\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n`))),mdx(\"p\",null,`It's great! but does the rest of the implementation really need to involve three\ndifferent classes?`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"SqlAlchemy\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__init__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"engine \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" create_engine\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"_session_maker \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" scoped_session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"sessionmaker\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"engine\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator annotation punctuation\"}),\"@property\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"unit_of_work_manager\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" SqlAlchemyUnitOfWorkManager\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"_session_maker\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"SqlAlchemyUnitOfWorkManager\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"UnitOfWorkManager\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__init__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" SessionFactory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" MessageBus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` session_factory\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` bus\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"start\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" SqlAlchemyUnitOfWork\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,\"Each class does have a purpose of course:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},`SqlAlchemy captures config info about SqlAlchemy and our database engine, it has\nmethods like create_schema that can re-create the database for us if we need.`),mdx(\"li\",{parentName:\"ul\"},`SqlAlchemyUnitOfWorkManager is meant to hold logic about when to create new database\nsessions and when to re-use existing ones, and it ties the message bus to each unit of\nwork.`),mdx(\"li\",{parentName:\"ul\"},`SqlAlchemyUnitOfWork is the actual context manager that holds the logic for commits,\nrollbacks, and publishing events atomically.`)),mdx(\"p\",null,`But can we make things a little simpler? SqlAlchemy (the library) already knows how\nmanage sessions for us. Perhaps we could just have one model for the database, and\nanother for the units of work?`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"from\"),\" sqlalchemy\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"orm \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),` sessionmaker\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"SqlAlchemy\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"__init__\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"engine \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" create_engine\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" sessionmaker\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"engine\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` bus\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"start_unit_of_work\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"return\"),\" SqlAlchemyUnitOfWork\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,`could you use an @contextmanager? We're down to just two classes. Next you might ask\nwhether you really need a class for your unit of work context manager. If your client\ncode doesn't need to call a commit method explicitly, then you might be able to get away\nwith a single method, using contextlib.contextmanager and the yield keyword:`),mdx(\"p\",null,\"from contextlib import contextmanager\"),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"class\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token class-name\"}),\"SqlAlchemy\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator annotation punctuation\"}),\"@contextmanager\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"start_unit_of_work\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        session `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"session_factory\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        events `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"try\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"yield\"),` session\n            self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"publish_events\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"commit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"except\"),\" Exception \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"as\"),\" e\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n            session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"rollback\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n            session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"close\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"publish_events\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"self\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        flushed_objects `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"new\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"+\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"dirty\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" o \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" flushed_objects\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n            `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" o\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`events\n                self`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"handle\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"e\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,`the singleton pattern in Python We still have one final class, SqlAlchemy, which exists\nto`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"know how to talk to our database\"),mdx(\"li\",{parentName:\"ul\"},\"give us units of work\"),mdx(\"li\",{parentName:\"ul\"},\"tie the message bus to it.\")),mdx(\"p\",null,`It's essentially a singleton, in that our application is only ever meant to have one\ninstance of it. There are lots of ways to implement the singleton pattern in Python\n`,\"[https://stackoverflow.com/questions/31875/is-there-a-simple-elegant-way-to-define-singletons]\"),mdx(\"p\",null,`In this case our implementation is the ultra-simple \"by convention there is only one\ninstance of this class\", which is has a lot going for it in terms of ways to implement\nthe singleton pattern, compared to all the complicated code-based solutions linked\nabove. If you do want a code-based solution, or if you want to continue experimenting\nwith non-class-based solutions to these problems, why not use the \"just use a module\"\nsolution - modules are essentially already singletons, in Python:`),mdx(\"div\",a({},{className:\"remark-highlight\"}),mdx(\"pre\",a({parentName:\"div\"},{className:\"language-python\"}),mdx(\"code\",a({parentName:\"pre\"},{className:\"language-python\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# adapters/sqlalchemy.py\"),`\n\nBUS `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"None\"),`\nSESSION_MAKER `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token boolean\"}),\"None\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token comment\"}),\"# to be called in our bootstrap/config script\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"setup\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" bus\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"global\"),\" BUS\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),` SESSION_MAKER\n  BUS `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),` bus\n  SESSION_MAKER `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" sessionmaker\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"create_engine\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"uri\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token decorator annotation punctuation\"}),\"@contextmanager\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"start_unit_of_work\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    session `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" SESSION_MAKER\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    events `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"try\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"yield\"),` session\n        _publish_events`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"commit\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"except\"),\" Exception \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"as\"),\" e\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n        session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"rollback\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n        session`,mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"close\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"def\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token function\"}),\"_publish_events\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n    flushed_objects `,mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"new\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token operator\"}),\"+\"),\" \",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" session\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"dirty\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" o \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" flushed_objects\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),`\n      `,mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"for\"),\" e \",mdx(\"span\",a({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" o\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"events BUS\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"handle\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"e\",mdx(\"span\",a({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`))),mdx(\"p\",null,`We may be drifting a little too far into \"removing classes for its own sake\" territory\nhere. But hopefully you now have a few more options to use for inspiration in your own\ncode.`),mdx(\"hr\",null),mdx(\"p\",null,\"*\",\"NARRATORS VOICE: Harry pretends to be an architect all the time\"))}MDXContent.isMDXComponent=!0;\n","scope":{}},"date":"2018-10-05","layout":"post","title":"Removing classes from Ports and Adapters","author":"Harry","categories":["ports \u0026 adapters"],"tags":["python","architecture"]},"__N_SSG":true},"page":"/[slug]","query":{"slug":"2018-10-05-removing-classes-from-ports-and-adapters"},"buildId":"KQTOltHZK9VDJbo-wcIP4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>